<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:pxt="http://www.peixoto.com.br/pxtFaces"
	xmlns:pxtfl="http://www.peixoto.com.br/jsf"
	xmlns:pxtfc="http://www.peixoto.com.br/jsf/core">

<ui:composition template="/META-INF/facelets/templates/crud.xhtml">
	<ui:param name="form_id" value="formPedido" />
	<ui:param name="backingBean" value="#{pedidoBean}" />
	<ui:param name="titulo" value="Pedido" />
	<ui:define name="btnFind"></ui:define>

	<ui:define name="panelCadastro">

		<pxt:panelGrid id="panelCodigoDescricao" columnsWidth="40%;40%;15%;5%"
			width="100%">

			<h:outputLabel value="Cliente:" styleClass="outputText" />

			<h:outputLabel value="Produto:" styleClass="outputText" />

			<h:outputLabel value="Quantidade:" styleClass="outputText" />

			<h:outputLabel value="" styleClass="outputText" />

			<pxtfl:searchField value="Pesquisar" id="searchCliente"
				controller="#{pedidoBean.searchCliente}" modalTitle="Cliente"
				disabledOn="#{pedidoBean.disabledOnDefault}" searchProperty="nome">
				<ui:define name="filtros">
					<pxt:panelGrid columnsWidth="10%;90%">
						<h:outputText value="CPF/CNPJ:" styleClass="outputText" />
						<h:inputText
							value="#{pedidoBean.searchCliente.searchObject.cpfCnpj}"
							maxlength="14" style="width: 30%;">
							<pxt:onlyNumber />
						</h:inputText>
						<h:outputText value="Nome:" styleClass="outputText" />
						<h:inputText value="#{pedidoBean.searchCliente.searchObject.nome}"
							maxlength="180" style="width:30%;">
						</h:inputText>
					</pxt:panelGrid>
				</ui:define>
				<ui:define name="colunas">
					<pxtfl:column headerValue="CPF/CNPJ" value="#{obj.cpfCnpj}"
						columnWidth="10%" />
					<pxtfl:column headerValue="Nome" value="#{obj.nome}"
						columnWidth="10%" />
				</ui:define>
			</pxtfl:searchField>

			<pxtfl:searchField value="Pesquisar" id="searchProduto"
				controller="#{pedidoBean.searchProduto}" modalTitle="Produto"
				disabledOn="#{pedidoBean.disabledOnDefault}"
				searchProperty="descricao">
				<ui:define name="filtros">
					<pxt:panelGrid columnsWidth="10%;90%">
						<h:outputText value="Código:" styleClass="outputText" />
						<h:inputText
							value="#{pedidoBean.searchProduto.searchObject.codigo}"
							maxlength="14" style="width: 10%;">
							<pxt:onlyNumber />
						</h:inputText>
						<h:outputText value="Descrição:" styleClass="outputText" />
						<h:inputText
							value="#{pedidoBean.searchProduto.searchObject.descricao}"
							maxlength="180" style="width:30%;">
						</h:inputText>
					</pxt:panelGrid>
				</ui:define>
				<ui:define name="colunas">
					<pxtfl:column headerValue="Código" value="#{obj.codigo}"
						columnWidth="10%" />
					<pxtfl:column headerValue="Descrição" value="#{obj.descricao}"
						columnWidth="10%" />
				</ui:define>
			</pxtfl:searchField>

			<h:inputText value="#{pedidoBean.quantidade}"
				disabled="#{pedidoBean.disabledOnDefault}" maxlength="18"
				style="width:90%">
				<pxt:onlyNumber />
			</h:inputText>

			<h:commandButton value="Adicionar"
				action="#{pedidoBean.adicionarItem()}" render="tabelaProdutos"
				style="width:98%" />

		</pxt:panelGrid>
	</ui:define>

	<ui:define name="table">
		<rich:panel id="tabPanelItens"
			bodyClass="pxt-rich-body-panel-detail zeroBodySpace">
			<rich:dataTable id="tabelaProdutos" var="item"
				value="#{pedidoBean.listaItens}"
				rowClasses="pxt-odd-row, pxt-even-row" styleClass="stable"
				footerClass="pxt-rf-dt-ftr-c" rowKeyVar="keyVar" rows="14">/>

				<pxtfl:column headerValue="Código" value="#{item.produto.codigo}"
					textAlign="center" />
				<pxtfl:column headerValue="Descrição"
					value="#{item.produto.descricao}" />
				<pxtfl:column headerValue="Quantidade" value="#{item.quantidade}"
					textAlign="center" />
				<pxtfl:column headerValue="Preço unitário"
					value="#{item.produto.valor}" textAlign="center" />
				<pxtfl:column headerValue="Total"
					value="#{item.produto.valor*item.quantidade}"
					footerValue = "#{pedidoBean.total}" textAlign="center" />

				<rich:column rendered="${!empty rederedEdit ? rederedEdit: true}"
					exportColumn="false" width="28px">
					<a4j:commandLink id="btnEditTable" accesskey="E"
						actionListener="#{backingBean.editar}" textAlign="center"
						render="toolbar, pnlCampos, pnlTable, mensagemGeral, messagePane">
						<f:param name="VALIDATION_OFF" value="true" />
						<h:graphicImage title="Editar o registro!" name="editar_16x16.png"
							library="pxt.framework.faces.img" style="border-width: 0px" />
					</a4j:commandLink>
				</rich:column>

				<f:facet name="footer">
					<rich:dataScroller id="tabelaProdutosScroller"
						renderIfSinglePage="false" align="left" render="tabelaProdutos" />
				</f:facet>
			</rich:dataTable>
		</rich:panel>
	</ui:define>

</ui:composition>
</html>